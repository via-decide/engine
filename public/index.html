<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Decide Engine | Production OS</title>

<style>
:root{
  --bg:#050505;
  --glass:rgba(255,255,255,0.05);
  --border:rgba(255,255,255,0.12);
  --accent:#ff671f;
  --success:#00e676;
  --font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
}
body{
  margin:0;
  background:var(--bg);
  color:#fff;
  font-family:var(--font);
  overflow:hidden;
}
#app{
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}
.slide{
  width:100%;
  max-width:600px;
  padding:30px;
  box-sizing:border-box;
}
h1{margin-top:0}
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:15px;
}
.card{
  background:var(--glass);
  border:1px solid var(--border);
  padding:20px;
  border-radius:16px;
  cursor:pointer;
  text-align:center;
}
.card.selected{
  border-color:var(--success);
  color:var(--success);
}
button{
  background:var(--accent);
  border:none;
  padding:14px 20px;
  border-radius:10px;
  font-weight:bold;
  cursor:pointer;
  width:100%;
  margin-top:15px;
}
button.secondary{
  background:transparent;
  border:1px solid var(--border);
}
.toast{
  position:fixed;
  bottom:40px;
  left:50%;
  transform:translateX(-50%);
  background:#111;
  padding:12px 20px;
  border-radius:40px;
  display:none;
}
</style>
</head>
<body>

<div id="app"></div>
<div id="toast" class="toast"></div>

<script>
/* =========================
   CORE ENGINE
========================= */

const DecideEngine = (() => {

  /* ---------- STATE ---------- */
  const State = {
    currentRoute: '/',
    data: {}
  };

  /* ---------- ROUTER ---------- */
  const Router = {
    routes:{},
    register(path, module){ this.routes[path] = module; },
    go(path){
      location.hash = path;
    },
    resolve(){
      const path = location.hash.replace("#","") || "/";
      State.currentRoute = path;
      if(this.routes[path]){
        this.routes[path].render();
      }
    }
  };

  /* ---------- STORAGE ---------- */
  const Storage = {
    save(key,val){ localStorage.setItem(key,JSON.stringify(val)); },
    load(key){ return JSON.parse(localStorage.getItem(key) || "null"); }
  };

  /* ---------- TOAST ---------- */
  function showToast(msg){
    const t=document.getElementById("toast");
    t.innerText=msg;
    t.style.display="block";
    setTimeout(()=>t.style.display="none",2000);
  }

  return { State, Router, Storage, showToast };

})();


/* =========================
   VIDEO JOB MODULE (ISOLATED)
========================= */

const VideoJobsModule = (() => {

  const PHONE_DB = [
    { name:"Samsung Galaxy S26 Ultra", price:129999 },
    { name:"iPhone 17 Pro", price:139999 },
    { name:"Pixel 10 Pro", price:99999 }
  ];

  let selected = [];
  let jobs = DecideEngine.Storage.load("videoJobs") || [];

  function render(){
    const app = document.getElementById("app");
    const phonesHTML = PHONE_DB.map((p,i)=>`
      <div class="card ${selected.includes(p.name) ? 'selected':''}"
           onclick="VideoJobsModule.toggle('${p.name}')">
        ðŸ“± ${p.name}
      </div>
    `).join("");

    app.innerHTML = `
      <div class="slide">
        <h1>Video Job Engine</h1>
        <div class="grid">${phonesHTML}</div>
        <button onclick="VideoJobsModule.create()">Create Video Job</button>
        <button class="secondary" onclick="DecideEngine.Router.go('/')">Home</button>
      </div>
    `;
  }

  function toggle(name){
    if(selected.includes(name)){
      selected = selected.filter(x=>x!==name);
    } else {
      selected.push(name);
    }
    render();
  }

  function create(){
    if(!selected.length){
      DecideEngine.showToast("Select at least one phone");
      return;
    }

    const job = {
      id:"JOB-"+Math.random().toString(36).substr(2,4).toUpperCase(),
      phones:[...selected],
      status:"QUEUED"
    };

    jobs.push(job);
    DecideEngine.Storage.save("videoJobs",jobs);
    selected=[];
    renderStatus(job);
    simulate(job);
  }

  function renderStatus(job){
    document.getElementById("app").innerHTML = `
      <div class="slide">
        <h1>${job.id}</h1>
        <p id="jobStatus">${job.status}</p>
        <button onclick="VideoJobsModule.render()">New Job</button>
        <button class="secondary" onclick="DecideEngine.Router.go('/')">Home</button>
      </div>
    `;
  }

  function simulate(job){
    setTimeout(()=>{
      job.status="PROCESSING";
      updateUI(job);
    },1500);

    setTimeout(()=>{
      job.status="COMPLETED";
      DecideEngine.Storage.save("videoJobs",jobs);
      updateUI(job);
      DecideEngine.showToast("Video Ready ðŸŽ¬");
    },4000);
  }

  function updateUI(job){
    const el=document.getElementById("jobStatus");
    if(el) el.innerText=job.status;
  }

  return { render, toggle, create };

})();


/* =========================
   HOME MODULE
========================= */

const HomeModule = {
  render(){
    document.getElementById("app").innerHTML = `
      <div class="slide">
        <h1>Decide OS</h1>
        <div class="grid">
          <div class="card" onclick="DecideEngine.Router.go('/video')">
            ðŸŽ¬ Video Jobs
          </div>
        </div>
      </div>
    `;
  }
};


/* =========================
   ROUTE REGISTRATION
========================= */

DecideEngine.Router.register("/", HomeModule);
DecideEngine.Router.register("/video", VideoJobsModule);

window.addEventListener("hashchange", () => DecideEngine.Router.resolve());
DecideEngine.Router.resolve();

</script>
</body>
</html>

